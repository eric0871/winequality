[["index.html", "Vinho Verde Wine Quality Analysis Chapter 1 Introduction", " Vinho Verde Wine Quality Analysis Sally Bao &amp; Eric Cheng &amp; Qiran Li &amp; Zhibin Li 2020-12-16 Chapter 1 Introduction Despite the covid-19 pandemic, we are all looking forward to celebrating Christmas safely with families and friends at home. As lots of people get the festivities started with a great glass of wine, we are excited to provide a brief introduction on the quality of Vinho Verde red and white wines from the north of Portugal. In our report, our goal is to identify the relationship between red/white quality and eleven physicochemical attributes. Note that, due to privacy and logistic issues, we have no access to wine brands, selling price, etc. For more information, see the reference [Cortez et al., 2009] http://www3.dsi.uminho.pt/pcortez/wine/. In this project, we plan to answer the questions as follows: What's the distribution of each attribute? Is it normally distrtibuted or skewed? Are there any attribute pairs have a linear correlation? What's the top 3 attributes that has the highest positive/negative correlation with red/white wine quality? "],["data-sources.html", "Chapter 2 Data sources 2.1 Dataset Summary", " Chapter 2 Data sources Eric is responsible for collecting the data. Fortunately, two datasets, related to Portuguese red and white Vinho Verde wine samples, are publicly available on UCI Machine Learning Repository: https://archive.ics.uci.edu/ml/datasets/wine+quality. 2.1 Dataset Summary 2.1.1 Number of Records red wine: 1599 examples white wine: 4898 examples 2.1.2 Attributes and Outcome In total, we have 11 attributes and 1 outcome (quality) for wine dataset. fixed acidity: non-volatile acid that do not evaporate readily (e.g. tartaric acid) Fixed Acidity is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. volatile acidity: high acetic acid in wine that leads to an unpleasant vinegar taste Volatile Acidity is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. citric acid: increases wine acidity and adds a fresh flavor to wine Citric Acid is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. residual sugar:: the amount of sugar remaining after fermentation. Note that more than 45 g/l is a 'sweet wine'. Residual Sugar is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. chlorides: the amount of salt in wine Chlorides is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. free sulfur dioxide: prevents microbial growth and the oxidation of wine Free Sulfur Dioxide is expressed in \\(\\frac{mg}{dm^{3}}\\) in this dataset. total sulfur dioxide: the portion of free SO2 plus the portion bound to other chemicals in wine Total sulfur dioxide is expressed in \\(\\frac{mg}{dm^{3}}\\) in this dataset. density: sweeter wines have a higher density Density is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. pH: the level of acidity on a scale of 0â€“14. Most wines range from 3 to 4 on the pH scale. sulphates: a food preservative to maintain the flavor and freshness of wine Sulphates is expressed in \\(\\frac{g}{dm^{3}}\\) in this dataset. alcohol: Note that the alcohol content of wine is between 5% and 23% ABV. Alcohol is measured in % vol or alcohol by volume (ABV) in this dataset. quality: a grading scale of wine quality that ranges from 0 (very bad) to 10 (excellent). 2.1.3 Types of Variables 11 attributes are all numeric and the outcome is integer. "],["data-transformation.html", "Chapter 3 Data transformation", " Chapter 3 Data transformation As our datasets are well organized in csv files, we just call read.csv to load in wine data. ## fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates ## 1 7.4 0.70 0.00 1.9 0.076 11 34 0.9978 3.51 0.56 ## 2 7.8 0.88 0.00 2.6 0.098 25 67 0.9968 3.20 0.68 ## 3 7.8 0.76 0.04 2.3 0.092 15 54 0.9970 3.26 0.65 ## 4 11.2 0.28 0.56 1.9 0.075 17 60 0.9980 3.16 0.58 ## 5 7.4 0.70 0.00 1.9 0.076 11 34 0.9978 3.51 0.56 ## 6 7.4 0.66 0.00 1.8 0.075 13 40 0.9978 3.51 0.56 ## alcohol quality ## 1 9.4 5 ## 2 9.8 5 ## 3 9.8 5 ## 4 9.8 6 ## 5 9.4 5 ## 6 9.4 5 ## fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide ## Min. : 4.60 Min. :0.1200 Min. :0.000 Min. : 0.900 Min. :0.01200 Min. : 1.00 Min. : 6.00 ## 1st Qu.: 7.10 1st Qu.:0.3900 1st Qu.:0.090 1st Qu.: 1.900 1st Qu.:0.07000 1st Qu.: 7.00 1st Qu.: 22.00 ## Median : 7.90 Median :0.5200 Median :0.260 Median : 2.200 Median :0.07900 Median :14.00 Median : 38.00 ## Mean : 8.32 Mean :0.5278 Mean :0.271 Mean : 2.539 Mean :0.08747 Mean :15.87 Mean : 46.47 ## 3rd Qu.: 9.20 3rd Qu.:0.6400 3rd Qu.:0.420 3rd Qu.: 2.600 3rd Qu.:0.09000 3rd Qu.:21.00 3rd Qu.: 62.00 ## Max. :15.90 Max. :1.5800 Max. :1.000 Max. :15.500 Max. :0.61100 Max. :72.00 Max. :289.00 ## density pH sulphates alcohol quality ## Min. :0.9901 Min. :2.740 Min. :0.3300 Min. : 8.40 Min. :3.000 ## 1st Qu.:0.9956 1st Qu.:3.210 1st Qu.:0.5500 1st Qu.: 9.50 1st Qu.:5.000 ## Median :0.9968 Median :3.310 Median :0.6200 Median :10.20 Median :6.000 ## Mean :0.9967 Mean :3.311 Mean :0.6581 Mean :10.42 Mean :5.636 ## 3rd Qu.:0.9978 3rd Qu.:3.400 3rd Qu.:0.7300 3rd Qu.:11.10 3rd Qu.:6.000 ## Max. :1.0037 Max. :4.010 Max. :2.0000 Max. :14.90 Max. :8.000 "],["missing-values.html", "Chapter 4 Missing values", " Chapter 4 Missing values "],["results.html", "Chapter 5 Results", " Chapter 5 Results read the data library(tidyverse) library(gridExtra) df&lt;- read.csv(&quot;resource/winequality-red.csv&quot;, sep = &#39;;&#39;, head = T) head(df) ## fixed.acidity volatile.acidity citric.acid residual.sugar chlorides free.sulfur.dioxide total.sulfur.dioxide density pH sulphates ## 1 7.4 0.70 0.00 1.9 0.076 11 34 0.9978 3.51 0.56 ## 2 7.8 0.88 0.00 2.6 0.098 25 67 0.9968 3.20 0.68 ## 3 7.8 0.76 0.04 2.3 0.092 15 54 0.9970 3.26 0.65 ## 4 11.2 0.28 0.56 1.9 0.075 17 60 0.9980 3.16 0.58 ## 5 7.4 0.70 0.00 1.9 0.076 11 34 0.9978 3.51 0.56 ## 6 7.4 0.66 0.00 1.8 0.075 13 40 0.9978 3.51 0.56 ## alcohol quality ## 1 9.4 5 ## 2 9.8 5 ## 3 9.8 5 ## 4 9.8 6 ## 5 9.4 5 ## 6 9.4 5 producing boxplots for each of the variables draw_box &lt;- function(df,variable) { plot &lt;- ggplot(data = df, aes(x = variable)) + geom_boxplot() + xlab(substring(deparse(substitute(variable)),4)) return(plot) } grid.arrange(draw_box(df, df$fixed.acidity), draw_box(df, df$volatile.acidity), draw_box(df, df$citric.acid), draw_box(df, df$residual.sugar), draw_box(df, df$chlorides), draw_box(df, df$free.sulfur.dioxide), draw_box(df, df$total.sulfur.dioxide), draw_box(df, df$density), draw_box(df, df$pH), draw_box(df, df$sulphates), draw_box(df, df$alcohol), draw_box(df, df$quality), ncol = 3) find correlation for each pairs of variables. library(GGally) ggpairs(df, upper = list(continuous = wrap(&quot;cor&quot;, size = 2.5)), axisLabels=&quot;none&quot;, progress = FALSE) Find correlation for each pairs of variables. library(ggcorrplot) cormap &lt;- round(cor(df),1) ggcorrplot(cormap, hc.order = TRUE, type = &quot;lower&quot;, lab = TRUE) When beginners first drink red wine, its much easier to taste the level of Sweetness and acidity of the red wine. We draw the scatterplot for residual sugar and volatile acidity with quality. We can see that only red wines with quality 4,5,6 have high and middle residual sugar and low and good quality red wines only have low residual sugar. So, if you feel the red wine is very sweet or even a little sweet, the quality red wine you drink is probably average. We also can see that only red wine with quality 3,4,5 has high volatile acidity. So, if you feel the red wine is very sour, the quality red wine you drink is probably low or average. grid.arrange( ggplot(data = df, aes(x = quality, y = residual.sugar)) + geom_jitter(aes(color = residual.sugar))+ scale_color_distiller(palette = &quot;RdYlGn&quot;)+ ggtitle(&#39;Residual sugar with quality&#39;)+ theme(legend.position=&quot;bottom&quot;), ggplot(data = df, aes(x = quality, y = volatile.acidity)) + geom_jitter(aes(color = volatile.acidity))+ scale_color_distiller(palette = &quot;RdYlGn&quot;)+ ggtitle(&#39;Volatile acidity with quality&#39;)+ theme(legend.position=&quot;bottom&quot;), ncol=2 ) library(tidyr) library(ggplot2) library(ggpubr) library(dplyr) library(reshape2) library(GGally) library(viridis) red_df &lt;- read.csv(&quot;resource/winequality-red.csv&quot;, sep = &#39;;&#39;, head = T) Lets create a new column quality_category to indicate whether a wine is good (quality &gt; 6), or average (quality = 5 or 6), or poor (quality &lt; 5) red_df$quality_category &lt;- cut(red_df$quality,breaks=c(2,4,6,9),labels = c(&#39;poor&#39;,&#39;average&#39;,&#39;good&#39;)) Let's first plot the histogram of every variable. ggplot(gather(red_df[1:12]), aes(value)) + geom_histogram(bins = 20) + facet_wrap(~key, scales = &#39;free_x&#39;) From the histogram, there are several things we observed: 1. Density, pH, volatile acidity are normally distributed. 2. Chlorides and residual sugar have low variance. 3. Alcohol level, fixed acidity, free sulfur dioxide, sulphates, and total sulfur dioxide are right skewed. 4. Citric acid has a plateau distribution. 5. Most wine has quality of 5 and 6. oldpar = par(mfrow = c(2,6)) for ( i in 1:12 ) { boxplot(red_df[[i]]) mtext(names(red_df)[i], cex = 0.8, side = 1, line = 2) } par(oldpar) From the boxplots, we have the following observations: 1. Every variable has outliers. 2. The median of our dependent variable - quality is 6. In order to discover the relationships between each variable, let's show the heatmap of correlation matrices. cm &lt;- round(cor(red_df[1:12]),2) melt_cm = melt(cm) ggplot(data = melt_cm,aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low = &quot;blue&quot;, high = &quot;red&quot;, mid = &quot;white&quot;, midpoint = 0, limit = c(-1,1), space = &quot;Lab&quot;) + geom_text(aes(Var2, Var1, label = value), color = &quot;black&quot;, size = 4) pairs(red_df[1:12], col = red_df$quality, lower_panel = NULL) From the heatmap, the variables that have high correlation with quality are alcohol, volatile acidity, sulphates, citric acid, and Next, let's take a look at some bavariate graphs of these variables. red_df$quality &lt;- as.factor(red_df$quality) a &lt;- ggplot(red_df, aes(x=quality, y=alcohol, fill=quality_category)) + geom_boxplot() + theme(legend.position = &quot;none&quot;) b &lt;- ggplot(red_df, aes(x=quality, y=volatile.acidity, fill=quality_category)) + geom_boxplot() c &lt;- ggplot(red_df, aes(x=quality, y=sulphates, fill=quality_category)) + geom_boxplot() + theme(legend.position = &quot;none&quot;) d &lt;- ggplot(red_df, aes(x=quality, y=citric.acid, fill=quality_category)) + geom_boxplot() + theme(legend.position = &quot;none&quot;) ggarrange(a, b, c, d, ncol = 2, nrow = 2, common.legend = TRUE, legend = &quot;right&quot;) Alcohol has the strongest correlation with quality in our dataset. And from this graph, we can clearly see this relationship. Better wines have a high alcohol percentage. It is either because strong wines are more tasty or people who rates wines are wine lovers and they favor strong wines. From the graph above, we can tell that volatile acidity has a negative relationship with quality. Better wines tend to have lower median of volatile acidity. Sulphates seems to have positive relationship with quality. Better wines have higher median of sulphates level. Citric acid seems to have positive relationship with quality. Better wines have higher median of citric acid level. The following graph could further justify the above mentioned relationship between wine quality and alcohol density. f1 = ggplot(red_df, aes(alcohol, quality, color = quality_category)) + geom_point() + facet_grid(cols = vars(quality_category)) + scale_fill_manual(labels=letters[1:3], values=c(&quot;red&quot;,&quot;blue&quot;,&quot;green&quot;)) f2 = ggplot(red_df, aes(volatile.acidity, quality, color = quality_category)) + geom_point() + facet_grid(cols = vars(quality_category)) + scale_fill_manual(labels=letters[1:3], values=c(&quot;red&quot;,&quot;blue&quot;,&quot;green&quot;)) f3 = ggplot(red_df, aes(sulphates, quality, color = quality_category)) + geom_point() + facet_grid(cols = vars(quality_category)) + scale_fill_manual(labels=letters[1:3], values=c(&quot;red&quot;,&quot;blue&quot;,&quot;green&quot;)) f4 = ggplot(red_df, aes(citric.acid, quality, color = quality_category)) + geom_point() + facet_grid(cols = vars(quality_category)) + scale_fill_manual(labels=letters[1:3], values=c(&quot;red&quot;,&quot;blue&quot;,&quot;green&quot;)) ggarrange(f1,f2,f3,f4, ncol = 2, nrow = 2, common.legend = TRUE) Then, let's study how the combination of two variables affect quality by looking at some multivariate graphs. red_df$quality &lt;- as.numeric(red_df$quality) ggplot(data = red_df, aes(x=alcohol,y=volatile.acidity,color = quality))+ geom_point()+ facet_wrap(red_df$quality_category)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) From the graph above, wee can see that good wines have higher alcohol and low volatile acidity levels than the other two groups with some outliers. The wine with the highest alcohol level scored only a 5 in quality. Also, the poor wines seem to have a dispersed distribution suggesting that people are consistent in the standards of good wines but inconsistent in the standards of poor wines. ggplot(data = red_df, aes(x=alcohol,y=chlorides,color = quality))+ geom_point()+ facet_wrap(red_df$quality_category)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) This graph is interesting because it shows that most wines that have high chlorides level are categorized as average wines. This pattern suggests that chlorides may have a non-linear relationship with quality. ggplot(data = red_df, aes(x=volatile.acidity,y=chlorides,color = quality))+ geom_point()+ facet_wrap(red_df$quality_category)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) This graph supports our theory before that people have consistent standards of good wine and inconsistent standards of poor wines. Because all good wines are clustered in the lower left corner of the graph and poor wines have dispersed distribution. q &lt;- cut(red_df$residual.sugar,breaks=4,labels = c(&quot;0-25&quot;,&quot;25-50&quot;,&quot;50-75&quot;,&quot;75-100&quot;)) ggplot(red_df, aes(fixed.acidity,alcohol,color = alcohol))+ geom_point()+ facet_wrap(q)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) This graph shows that for low fixed.acidity and high alcohol, the wine's residual.sugar values usually remain at very low level. red_df$taste &lt;- cut(red_df$quality,breaks=2,labels = c(&#39;poor&#39;,&#39;good&#39;)) ggparcoord(red_df, columns = c(1,2,3,4,10,11), alphaLines = .1 , scale = &quot;globalminmax&quot;, splineFactor = 1, groupColumn = 14) From the above parallel coordinate plot, it can further validate our correlation relationships between different variables. It can also indicates which factor leads to good taste for the red wine. red_df$quality &lt;- as.numeric(red_df$quality) ggplot(data = red_df, aes(x=alcohol,y=volatile.acidity,color = quality))+ geom_point()+ facet_wrap(red_df$quality_category)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) From the graph above, wee can see that good wines have higher alcohol and low volatile acidity levels than the other two groups with some outliers. The wine with the highest alcohol level scored only a 5 in quality. Also, the poor wines seem to have a dispersed distribution suggesting that people are consistent in the standards of good wines but inconsistent in the standards of poor wines. ggplot(data = red_df, aes(x=alcohol,y=chlorides,color = quality))+ geom_point()+ facet_wrap(red_df$quality_category)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) This graph is interesting because it shows that most wines that have high chlorides level are categorized as average wines. This pattern suggests that chlorides may have a non-linear relationship with quality. ggplot(data = red_df, aes(x=volatile.acidity,y=chlorides,color = quality))+ geom_point()+ facet_wrap(red_df$quality_category)+ scale_colour_gradient(low = &quot;Blue&quot;, high = &quot;Orange&quot;, na.value = &quot;black&quot;) This graph supports our theory before that people have consistent standards of good wine and inconsistent standards of poor wines. Because all good wines are clustered in the lower left corner of the graph and poor wines have dispersed distribution. "],["interactive-component.html", "Chapter 6 Interactive component", " Chapter 6 Interactive component "],["conclusion.html", "Chapter 7 Conclusion", " Chapter 7 Conclusion "]]
