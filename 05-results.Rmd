# Results

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(gridExtra)

df<- read.csv("resource/winequality-red.csv", sep = ';', head = T)
df$quality.category <- cut(df$quality,breaks=c(2,4,6,9),labels = c('poor','average','good'))
```

## Distribution and Outliers

### Histogram for Attributes
```{r,warning=FALSE,message=FALSE}
library(MASS)
oldpar = par(mfrow = c(3,4))
for ( i in 1:12 ) {
  truehist(df[[i]], xlab = names(df)[i], col = 'lightblue', main = paste("Average =", signif(mean(df[[i]]),3)))
}
```

From the histogram, there are several things we observed:

1. Volatile acidity, density, and pH seem to be normally distributed.

2. Alcohol level, fixed acidity, free sulfur dioxide, sulphates, and total sulfur dioxide are right skewed.

3. Chlorides and residual sugar have relatively low variance.

4. Citric acid seems to have a plateau-shaped distribution.

5. Most wine has the quality of 5 and 6.


### Boxplot for Attributes
```{r,warning=FALSE,message=FALSE}
graph = par(mfrow = c(2,6))
for ( i in 1:12 ) {
  boxplot(red_df[[i]])
  mtext(names(red_df)[i], cex = 0.8, side = 1, line = 2)
}
par(graph)
```

From the boxplot, there are several things we observed:

1. All the attributes have quite many outliers except citric.acid and alcohol. The observation might indicate better data in these two attributes and we would keey an eye on them while conducting correlation analysis.

2. The median of our dependent variable - quality is 6.


## Pairwise Attribute Correlation 

### Scatterplot Matrix
```{r,warning=FALSE,message=FALSE}
library(GGally)
#ggpairs(df, upper = list(continuous = wrap("cor", size = 3)), axisLabels="none", progress = FALSE)
pairs(df[1:12], lower_panel = NULL)
```
```{r,warning=FALSE,message=FALSE}
pairs(df[,c(1,2,3,8, 9, 11)])
```

### Correlation Heatmap

```{r,warning=FALSE,message=FALSE}
library(ggcorrplot)
cormap <- round(cor(df[1:12]),2)
ggcorrplot(cormap, type = "lower", lab = TRUE, lab_size=3)
```

From both the scattorplot matrix and correlation heatmap, we observe that the following pairs of variables seem to have a linear correlation:

- strong positive correlation: fixed acidity/citric acid, fixed acidity/density

- strong negative correlation: fixed acidity/pH, density/alcohol

The observation is consistent with one of our conjectures: the sweeter the red wine is, the higher is the density.


## Correlation between Quality and Attributes
```{r,warning=FALSE,message=FALSE}
library(ggcorrplot)
cormap <- round(cor(df[1:12]),2)
ggcorrplot(cormap, type = "lower", lab = TRUE, lab_size=3)
```
Recall the correlation heatmap, we can also tell attributes such as alcohol, citric acid and volatile acidity seem to have a linear correlation with quality.


### Sweetness and Sourness v.s. Quality

```{r,warning=FALSE,message=FALSE}
grid.arrange(
  ggplot(data = df, aes(x = quality.category, y = residual.sugar)) +
  geom_jitter(aes(color = residual.sugar))+
scale_color_distiller(palette = "RdYlGn")+
    ggtitle('Residual Sugar vs Quality')+
  theme(legend.position="bottom"),
ggplot(data = df, aes(x = quality.category, y = volatile.acidity)) +
  geom_jitter(aes(color = volatile.acidity))+
scale_color_distiller(palette = "RdYlGn")+
    ggtitle('Volatile acidity vs Quality')+
  theme(legend.position="bottom"),
ncol=2
)
```

When rookies first drink red wine, it's much easier to taste the level of sweetness and acidity. This common sense is consistent with our scatterplot for residual sugar and volatile acidity versus quality. 

- Residual Sugar vs Quality 

We can see that only red wines with quality on or below average have high and middle residual sugar, while red wines with good quality only have low residual sugar. So, if the red wine you taste is very sweet , the quality of the red wine you drink is probably **on or below average**.

- Volatile acidity vs Quality 

Observe that only red wines with quality on or below average has high volatile acidity. So, if you taste the red wine is very sour, the quality red wine you drink is probably on or below average.

However, we have to keep in mind that the scattorplot above doesn't generate any linear correlation between quality and sweetness/sourness. 


```{r,warning=FALSE,message=FALSE}
df$quality <- as.factor(df$quality.category)

b <- ggplot(df, aes(x=quality, y=volatile.acidity, fill=quality)) + 
  geom_boxplot() 

c <- ggplot(df, aes(x=quality, y=residual.sugar, fill=quality)) + 
  geom_boxplot() + theme(legend.position = "none")

ggarrange(b, c, ncol = 2, nrow = 1,
                    common.legend = TRUE, legend = "right")
```

Now, from the boxplot above, we observe that there seems to be no linear correlation between quality and residual sugar. On the contrary, quality and volatile acidity seems to be negatively correlated. That is, the lower volatile acidity implies the better quality.



## Alcohol v.s. Quality

```{r,warning=FALSE,message=FALSE}
 a<-  ggplot(df, aes(x=quality, y=alcohol, fill=quality)) + 
    geom_boxplot() + theme(legend.position = "none")+
    ggtitle('Alcohol vs Quality')+
    theme(legend.position="bottom")

 b<-  ggplot(red_df, aes(alcohol, quality, color = quality_category)) + 
    geom_point() + 
    facet_grid(cols = vars(quality_category)) +
    scale_fill_manual(labels=letters[1:3], values=c("red","blue","green"))

ggarrange(a, b, ncol = 2, nrow = 1,
                    common.legend = TRUE, legend = "right")
```

Alcohol has the strongest positive correlation with quality in our dataset. And from this graph, we can clearly see this relationship. Better wines have a high alcohol percentage. It is either because strong wines are more tasty or people who rates wines are wine lovers and they favor strong wines.



## ?
```{r}
library(tidyr)
library(dplyr)
library(reshape2)

red_df <- read.csv("resource/winequality-red.csv", sep = ';', head = T)
red_df$quality_category <- cut(red_df$quality,breaks=c(2,4,6,9),labels = c('poor','average','good'))
```

The following graph could further justify the above mentioned relationship between wine quality and alcohol density. 
```{r,warning=FALSE,message=FALSE}
f1 = ggplot(red_df, aes(alcohol, quality, color = quality_category)) + 
  geom_point() + 
  facet_grid(cols = vars(quality_category)) +
  scale_fill_manual(labels=letters[1:3], values=c("red","blue","green"))

f2 = ggplot(red_df, aes(volatile.acidity, quality, color = quality_category)) + 
  geom_point() + 
  facet_grid(cols = vars(quality_category)) +
  scale_fill_manual(labels=letters[1:3], values=c("red","blue","green"))


f3 = ggplot(red_df, aes(sulphates, quality, color = quality_category)) + 
  geom_point() + 
  facet_grid(cols = vars(quality_category)) +
  scale_fill_manual(labels=letters[1:3], values=c("red","blue","green"))

f4 = ggplot(red_df, aes(citric.acid, quality, color = quality_category)) + 
  geom_point() + 
  facet_grid(cols = vars(quality_category)) +
  scale_fill_manual(labels=letters[1:3], values=c("red","blue","green"))

ggarrange(f1,f2,f3,f4, ncol = 2, nrow = 2,
                    common.legend = TRUE)

```


## Pair Attributes v.s. Quality

Then, let's study how the combination of two variables affects quality by looking at some multivariate graphs.

### Alcohol + Volatile Acidity
```{r,warning=FALSE,message=FALSE}
red_df$quality <- as.numeric(red_df$quality)
ggplot(data = red_df, aes(x=alcohol,y=volatile.acidity,color = quality))+
  geom_point()+
  facet_wrap(red_df$quality_category)+
  scale_colour_gradient(low = "Blue",
                        high = "Orange", na.value = "black")

```

From the graph above, wee can see that good wines have higher alcohol and low volatile acidity levels than the other two groups with some outliers. The wine with the highest alcohol level scored only a 5 in quality.
Also, the poor wines seem to have a dispersed distribution suggesting that people are consistent in the standards of good wines but inconsistent in the standards of poor wines.

### Alcohol + Chlorides
```{r,warning=FALSE,message=FALSE}
ggplot(data = red_df, aes(x=alcohol,y=chlorides,color = quality))+
  geom_point()+
  facet_wrap(red_df$quality_category)+
  scale_colour_gradient(low = "Blue",
                        high = "Orange", na.value = "black")
```

This graph is interesting because it shows that most wines that have high chlorides level are categorized as average wines. This pattern suggests that chlorides may have a non-linear relationship with quality.

### Volatile Acidity + Chlorides
```{r,warning=FALSE,message=FALSE}
ggplot(data = red_df, aes(x=volatile.acidity,y=chlorides,color = quality))+
  geom_point()+
  facet_wrap(red_df$quality_category)+
  scale_colour_gradient(low = "Blue",
                        high = "Orange", na.value = "black")
```

This graph supports our theory before that people have consistent standards of good wine and inconsistent standards of poor wines. Because all good wines are clustered in the lower left corner of the graph and poor wines have dispersed distribution.


## Parallel Coordinate Plot
```{r}
library(tidyr)
library(dplyr)
library(reshape2)

red_df <- read.csv("resource/winequality-red.csv", sep = ';', head = T)
red_df$quality_category <- cut(red_df$quality,breaks=c(2,4,6,9),labels = c('poor','average','good'))
```

```{r,warning=FALSE,message=FALSE}
red_df$taste <- cut(red_df$quality,breaks=2,labels = c('poor','good'))
ggparcoord(red_df, columns = c(1,2,3,4,10,11), alphaLines = .1
           , scale = "globalminmax", splineFactor = 1, groupColumn = 14)+
  ggtitle('Attributes vs Quality')
```
From the above parallel coordinate plot, it can further validate our correlation relationships between different variables. It can also indicates which factor leads to good taste for the red wine. 








