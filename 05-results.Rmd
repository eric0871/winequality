# Results

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyr)
library(ggplot2)
library(dplyr)
library(reshape2)

red_df <- read.csv("resource/winequality-red.csv", sep = ';', head = T)

head(red_df)

```

Lets create a new column quality_category to indicate whether a wine is good (quality > 6), or average (quality = 5 or 6), or poor (quality < 5)

```{r}
red_df$quality_category <- cut(red_df$quality,breaks=c(2,4,6,9),labels = c('poor','average','good'))
```


Let's first plot the histogram of every variable.

```{r}
ggplot(gather(red_df[1:12]), aes(value)) + 
  geom_histogram(bins = 20) + 
  facet_wrap(~key, scales = 'free_x')
```

From the histogram, there are several things we observed:
1. Density, pH, volatile acidity are normally distributed.
2. Chlorides and residual sugar have low variance.
3. Alcohol level, fixed acidity, free sulfur dioxide, sulphates, and total sulfur dioxide are right skewed.
4. Citric acid has a plateau distribution.
5. Most wine has quality of 5 and 6.

```{r}
oldpar = par(mfrow = c(2,6))
for ( i in 1:12 ) {
  boxplot(red_df[[i]])
  mtext(names(red_df)[i], cex = 0.8, side = 1, line = 2)
}
par(oldpar)
```

From the boxplots, we have the following observations:
1. Every variable has outliers.
2. The median of our dependent variable - quality is 6.


In order to discover the relationships between each variable, let's show the heatmap of correlation matrices.

```{r}
cm <- round(cor(red_df[1:12]),2)
melt_cm = melt(cm)

ggplot(data = melt_cm,aes(x=Var1, y=Var2, fill=value)) + 
  geom_tile() +
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", 
                       midpoint = 0, limit = c(-1,1), space = "Lab") +
  geom_text(aes(Var2, Var1, label = value), color = "black", size = 4)
```


```{r}
pairs(red_df[1:12], col = red_df$quality, lower_panel = NULL)
```

From the heatmap, the variables that have high correlation with quality are alcohol, volatile acidity, sulphates,  citric acid, and .
Next, let's take a look at some bavariate graphs of these variables.



```{r}
red_df$quality <- as.factor(red_df$quality)

ggplot(red_df, aes(x=quality, y=alcohol, fill=quality_category)) + 
  geom_boxplot()
```

Alcohol has the strongest correlation with quality in our dataset. And from this graph, we can clearly see this relationship. Better wines have a high alcohol percentage. It is either because strong wines are more tasty or people who rates wines are wine lovers and they favor strong wines.


```{r}
red_df$quality <- as.factor(red_df$quality)

ggplot(red_df, aes(x=quality, y=volatile.acidity, fill=quality_category)) + 
  geom_boxplot()
```

From the graph above, we can tell that volatile acidity has a negative relationship with quality. Better wines tend to have lower median of volatile acidity.

```{r}
ggplot(red_df, aes(x=quality, y=sulphates, fill=quality_category)) + 
  geom_boxplot()
```

Sulphates seems to have positive relationship with quality. Better wines have higher median of sulphates level.

```{r}
ggplot(red_df, aes(x=quality, y=citric.acid, fill=quality_category)) + 
  geom_boxplot()
```

Citric acid seems to have positive relationship with quality. Better wines have higher median of citric acid level.

Then, let's study how the combination of two variables affect quality by looking at some multivariate graphs.

```{r}
red_df$quality <- as.numeric(red_df$quality)
ggplot(data = red_df, aes(x=alcohol,y=volatile.acidity,color = quality))+
  geom_point()+
  facet_wrap(red_df$quality_category)+
  scale_colour_gradient(low = "Blue",
                        high = "Orange", na.value = "black")

```

From the graph above, wee can see that good wines have higher alcohol and low volatile acidity levels than the other two groups with some outliers. The wine with the highest alcohol level scored only a 5 in quality.
Also, the poor wines seem to have a dispersed distribution suggesting that people are consistent in the standards of good wines but inconsistent in the standards of poor wines.

```{r}
ggplot(data = red_df, aes(x=alcohol,y=chlorides,color = quality))+
  geom_point()+
  facet_wrap(red_df$quality_category)+
  scale_colour_gradient(low = "Blue",
                        high = "Orange", na.value = "black")
```

This graph is interesting because it shows that most wines that have high chlorides level are categorized as average wines. This pattern suggests that chlorides may have a non-linear relationship with quality.

```{r}
ggplot(data = red_df, aes(x=volatile.acidity,y=chlorides,color = quality))+
  geom_point()+
  facet_wrap(red_df$quality_category)+
  scale_colour_gradient(low = "Blue",
                        high = "Orange", na.value = "black")
```

This graph supports our theory before that people have consistent standards of good wine and inconsistent standards of poor wines. Because all good wines are clustered in the lower left corner of the graph and poor wines have dispersed distribution.
